Command Name,Command,Reference Value
1. Check tach_var_ra_khoi_source - a,dmidecode -t system | grep -w RDO,Get list/check prerequisite
1. Check tach_var_ra_khoi_source - b,cat /etc/fstab | grep -w /var,Empty result
2. Check phan_vung_ud_ko_nam_chung_source - a,cat /etc/fstab | grep -vw #\|/\|/var\|/dev/shm\|/home\|/usr\|/proc\|/sys\|/dev/pts\|/opt\|swap\|/boot\|/boot/efi,Empty result
3. Check timezone - a,date +%Z %z | grep -w 0700,Contains '+0700'
4. Check sudoers1 - a,echo -e %wheel\tALL=(ALL)\tALL,Get list/check prerequisite
4. Check sudoers1 - b,cat /etc/sudoers | grep -v ^# | grep $standard,Empty result
5. Check sudoers2 - a,echo -e ALL=(ALL)\tALL,Get list/check prerequisite
5. Check sudoers2 - b,cat /etc/passwd |grep /bin/bash  | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',Empty result
5. Check sudoers2 - c,cat /etc/sudoers | grep -v ^# | grep -w $i | grep $standard,Empty result
6. Check sudoers3 - a,echo -e ALL=(ALL)  NOPASSWD: ALL,Get list/check prerequisite
6. Check sudoers3 - b,cat /etc/passwd |grep /bin/bash  | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',Empty result
6. Check sudoers3 - c,cat /etc/sudoers | grep -v ^# | grep -w $i | grep $standard,Empty result
7. Check ud_ko_dung_root - a,ps -ef | grep ^root | grep java\|tomcat\|jre\|jdk\|kubelet | grep -v grep,Empty result
8. Check duphong_bond1 - a,dmidecode -t system | grep -w VMware\|RDO,Get list/check prerequisite
8. Check duphong_bond1 - b,ip a | grep bond[0-9]: | awk '{print $2}' | awk -F: '{print $1}' | grep bond[0-9] | grep -v @bond,Empty result
8. Check duphong_bond1 - c,cat /proc/net/bonding/$i | grep Slave Interface | wc -l,Empty result
8. Check duphong_bond1 - d,cat /proc/net/bonding/$i | grep Slave Interface | awk '{print $3}',Empty result
8. Check duphong_bond1 - e,cat /proc/net/bonding/$i | grep -A 2 Slave Interface: $j| grep MII Status | awk '{print $3}',Empty result
9. Check duphong_bond2 - a,dmidecode -t system | grep -w VMware\|RDO,Get list/check prerequisite
9. Check duphong_bond2 - b,ip a | grep bond[0-9]: | awk '{print $2}' | awk -F: '{print $1}' | grep bond[0-9] | grep -v @bond,Empty result
9. Check duphong_bond2 - c,cat /etc/sysconfig/network-scripts/ifcfg-$i | grep -v ^# | grep mode | cut -d '' -f 2 | awk '{print $1}',Empty result
9. Check duphong_bond2 - d,cat /proc/net/bonding/$i | grep Bonding Mode,Empty result
10. Check san_multipath - a,dmsetup status| grep -vw linear |awk '{print $1}'| sed -e 's/://g'| grep -v p[0-9]$| grep -v No,Get list/check prerequisite
10. Check san_multipath - b,multipath -ll $line | grep running$| wc -l,Empty result
11. Check kdump_service - a,systemctl status kdump | grep Active: active,Empty result
12. Check sendmail_off - a,systemctl status sendmail | grep Active: active,Empty result
13. Check postfix_off - a,systemctl status postfix | grep Active: active,Empty result
14. Check hearbeat_port - a,ip a | grep $line | grep mtu 9000,Empty result
15. Check bo_card_mang_ao - a,ifconfig -a | grep virbr,Get list/check prerequisite
15. Check bo_card_mang_ao - b,cat /etc/selinux/config | grep -v ^# | grep SELINUX=,Empty result
15. Check bo_card_mang_ao - c,sestatus | grep Current mode | grep enforcing,Empty result
17. Check nf_conntrack_max - a,cat $standard,Empty result
18. Check hashsize - a,cat $standard,Empty result
19. Check pass_never_expired - a,cat /etc/passwd |grep /bin/bash  | grep -v ^# | grep -v nobody | awk -F: '($3>=1000) {print $1}',Get list/check prerequisite
19. Check pass_never_expired - b,chage -l $user | grep Password expires |  awk '{print $4}',Specific value match
20. Check max_open_file_user - a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',Get list/check prerequisite
20. Check max_open_file_user - b,cat /etc/security/limits.conf | grep -v ^# | grep -w $user | grep -v soft | grep -w nofile,Non-empty result
21. Check max_process_user - a,cat /etc/passwd |grep /bin/bash  | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',Get list/check prerequisite
21. Check max_process_user - b,cat /etc/security/limits.conf | grep -v ^# | grep -w $user | grep -v soft | grep -w nproc,Non-empty result
22. Check max_open_file_user - a,cat /proc/sys/fs/file-max,Get list/check prerequisite
22. Check max_open_file_user - b,cat /etc/sysctl.conf | grep -v ^# | grep -w  fs.file-max,Non-empty result
23. Check bluetooth_off - a,systemctl status bluetooth | grep Active: active,Empty result
24. Check cupsd_off - a,systemctl status cups | grep Active: active,Empty result
25. Check per_user_trong_groupsudo1 - a,cat /etc/pam.d/su | grep -v ^# | grep -w auth | grep -w required | grep -w pam_wheel.so,Empty result
26. Check per_user_trong_groupsudo2 - a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',Get list/check prerequisite
26. Check per_user_trong_groupsudo2 - b,cat /etc/group | grep wheel | grep $user,Empty result
27. Check password1 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w minlen = 8,Empty result
28. Check password2 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w dcredit = -1,Empty result
29. Check password3 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w ucredit = -1,Empty result
30. Check password4 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w lcredit = -1,Empty result
31. Check password5 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w ocredit = -1,Empty result
32. Check password6 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w maxrepeat = 3,Empty result
33. Check password7 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w enforcing = 1,Empty result
34. Check password8 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w retry = 3,Empty result
35. Check password9 - a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w enforce_for_root,Empty result
36. Check pass_encryp_1 - a,cat /etc/pam.d/password-auth | grep -v ^# | grep -w password | grep -w sha512,Empty result
37. Check pass_encryp_2 - a,cat /etc/security/pwhistory.conf | grep -v ^# | grep -w remember = 5,Empty result
38. Check thuat_toan_mahoa - a,cat /etc/login.defs | grep -v ^# | grep ENCRYPT_METHOD | grep SHA512,Empty result
39. Check cau_hinh_ssh_protocol - a,cat /etc/ssh/sshd_config | grep -v ^# | grep -w Protocol 2,Empty result
40. Check cau_hinh_ssh_permitrootlogin - a,cat /etc/ssh/sshd_config | grep -v ^# | grep -w PermitRootLogin no,Empty result
41. Check cau_hinh_ssh_allowusers - a,cat /etc/passwd |grep /bin/bash  | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',Get list/check prerequisite
41. Check cau_hinh_ssh_allowusers - b,cat /etc/ssh/sshd_config | grep -v ^# | grep -w AllowUsers | grep -w $user,Specific value match
42. Check tudong_off_ssh_1 - a,cat /etc/profile | grep -v ^# | grep -w TMOUT=300 -A 2 | grep -w readonly TMOUT -A 1 | grep -w export TMOUT,Empty result
43. Check tudong_off_ssh_2 - a,cat /etc/profile | grep -v ^# | grep TMOUT=300 | wc -l,Specific value match
44. Check bandwidth_net - a,ip a | grep state UP | awk '{print $2}'| awk -F: '{print $1}',Get list/check prerequisite
44. Check bandwidth_net - b,ethtool $i | grep Speed | awk '{print $2}'| awk -FM '{print $1}',>= 1000
45. Check openssl_ver - a,openssl version -a | grep $i,Non-empty result
46. Check file_unowner - a,find / -xdev \( -nouser -o -nogroup \) -print,Empty result
47. Check bien_moitruong - a,echo $PATH | grep \./\|::\|/tmp,Empty result
48. Check cau_hinh_crontab1 - a,ls /etc/ | grep cron.deny,Empty result
49. Check cau_hinh_crontab2 - a,ls /etc/ | grep cron.allow,Empty result
50. Check cau_hinh_crontab_min - a,crontab -l | grep -v ^# | grep -v sd_agent | grep -v scms-agent,Get list/check prerequisite
50. Check cau_hinh_crontab_min - b,crontab -l | grep -v ^# | grep sd_agent | grep sd_agent_monitor.sh,Empty result
50. Check cau_hinh_crontab_min - c,crontab -l | grep -v ^# | grep scms-agent | grep scms-mon,Empty result
50. Check cau_hinh_crontab_min - d,cat /etc/logrotate.conf | grep -v ^# | grep -w $i,Empty result
50. Check cau_hinh_crontab_min - e,cat /etc/logrotate.d/syslog | grep -v ^# | grep -w $i,Empty result
50. Check cau_hinh_crontab_min - f,cat /etc/logrotate.d/iptables | grep -v ^# | grep -w $i,Empty result
50. Check cau_hinh_crontab_min - g,cat /etc/logrotate.d/btmp | grep -v ^# | grep -w $i,Empty result
50. Check cau_hinh_crontab_min - h,cat /etc/logrotate.d/wtmp | grep -v ^# | grep -w $i,Empty result
50. Check cau_hinh_crontab_min - i,cat /etc/bashrc | grep -v ^# | grep local6.debug | grep ctty,Empty result
50. Check cau_hinh_crontab_min - j,cat /etc/rsyslog.conf | grep -v ^# | grep -w $i,Empty result
50. Check cau_hinh_crontab_min - k,tail -100 /var/log/cmdlog.log | grep $value,Empty result
50. Check cau_hinh_crontab_min - l,cat /etc/bashrc | grep -v ^# | grep export PROMPT_COMMAND | grep local6.debug | wc -l,Empty result
50. Check cau_hinh_crontab_min - m,cat /etc/rsyslog.conf | grep -v ^# | grep local6 | grep /var/log/cmdlog.log | wc -l,Empty result
50. Check cau_hinh_crontab_min - n,cat /etc/rsyslog.conf | grep -v ^# | grep kern.debug | grep /var/log/iptables/iptables.log | wc -l,Empty result
62. Check iptables_status - a,systemctl status iptables| grep Active: active,Empty result
63. Check zone_reclaim_mode - a,cat /proc/sys/vm/zone_reclaim_mode,Specific value match
64. Check mysql_not_active - a,ps -ef | grep mysql | grep -v ^root,Empty result
65. Check phan_vung_swap - a,cat /proc/swaps | tail -n+2,Empty result
66. Check oracle_scan_order - a,cat /etc/sysconfig/oracleasm | grep -v ^#| grep ORACLEASM_SCANORDER | grep -i dm |wc -l,Specific value match
66. Check oracle_scan_order - b,cat /etc/sysconfig/oracleasm | grep -v ^#| grep ORACLEASM_SCANEXCLUDE | grep -i sd |wc -l,Specific value match
67. Check haveged_service_on - a,dmidecode -t system | grep -i Vmware\|OpenStack,Get list/check prerequisite
67. Check haveged_service_on - b,rpm -qa | grep haveged,Empty result
67. Check haveged_service_on - c,service haveged status 2>/dev/null | grep running,Empty result
68. Check basic_package - a,rpm -qa | grep ^$i-,Non-empty result
69. Check swappiness - a,cat /proc/sys/vm/swappiness,Empty result
70. Check repo_taptrung - a,curl --connect-timeout 3 -s -o /dev/null -I -w %{http_code} 10.60.129.132,Condition-based
71. Check chronyd_status - a,systemctl status chronyd | grep Active: active,Empty result
72. Check chronyd_config - a,cat /etc/chrony.conf | grep -v ^# | grep @{chrony_server},Empty result
73. Check time_synchronization - a,chronyc sources | grep @{chrony_server} | awk '{print $5}',Specific value match
74. Check lldp_service - a,dmidecode -t system | grep -w VMware\|RDO,Get list/check prerequisite
74. Check lldp_service - b,rpm -qa | grep ^lldpd-,Non-empty result
75. Check lldp_show_neighbor - a,dmidecode -t system | grep -w VMware\|RDO,Get list/check prerequisite
75. Check lldp_show_neighbor - b,lldpcli show neighbors | grep LLDP neighbors:,Non-empty result
76. Check ipx_installed - a,which ipx | grep /bin/ipx,Empty result
77. Check iptables1 - a,iptables -S INPUT | tail -1 | grep \-A INPUT \-j DROP\|\-A INPUT \-j REJECT,Empty result
78. Check iptables2 - a,iptables -S INPUT | tail -2 | head -1 | grep \-A INPUT \-j LOG,Empty result
79. Check iptables3 - a,iptables -S OUTPUT | tail -1 | grep \-A OUTPUT \-j DROP\|\-A OUTPUT \-j REJECT,Empty result
80. Check iptables4 - a,iptables -S OUTPUT | tail -2 | head -1 | grep \-A OUTPUT \-j LOG,Empty result
