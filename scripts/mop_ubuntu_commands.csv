Command Name,Command,Reference Value
1. Check tach_var_ra_khoi_source - 1a,dmidecode -t system | grep -w RDO,Empty result (no VMware/RDO)
1. Check tach_var_ra_khoi_source - 1b,cat /etc/fstab | grep -w /var,Non-empty result (partition exists)
2. Check phan_vung_ud_ko_nam_chung_source - 2a,cat /etc/fstab | grep -vw '#\|/\|/var\|/dev/shm\|/home\|/usr\|/proc\|/sys\|/dev/pts\|/opt\|swap\|/boot\|/boot/efi',Non-empty result (application partitions exist)
3. Check timezone - 3a,"date +\%Z %z\"" | grep -w 0700""",Contains '+0700'
4. Check sudoers1 - 4a,cat /etc/sudoers | grep -v ^# | grep '%sudo\tALL=(ALL:ALL) ALL',Empty result (rule not exists)
5. Check sudoers2 - 5a,cat /etc/sudoers | grep -v ^# | grep '%admin ALL=(ALL) ALL',Empty result (rule not exists)
6. Check sudoers3 - 6a,cat /etc/passwd | grep sh$ | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with shell access
6. Check sudoers3 - 6b,"cat /etc/sudoers | grep -v ^# | grep -w \$user\"" | grep 'ALL=(ALL:ALL) ALL'""",Empty result for each user
7. Check ud_ko_dung_root - 7a,ps -ef | grep ^root | grep 'java\|tomcat\|jre\|jdk\|kubelet' | grep -v grep,Empty result (no root processes)
8. Check duphong_bond1 - 8a,ps -ef | grep ^root | grep 'java\|tomcat\|jre\|jdk\|kubelet' | grep -v grep,Empty result (no root processes)
9. Check duphong_bond2 - 9a,dmidecode -t system | grep -w 'VMware\|RDO',Contains VMware or RDO
9. Check duphong_bond2 - 9b,ip a | grep 'bond[0-9]:' | awk '{print $2}' | awk -F: '{print $1}' | grep 'bond[0-9]' | grep -v '@bond',List of bond interfaces
9. Check duphong_bond2 - 9c,"cat /proc/net/bonding/\$bond\"" | grep 'Slave Interface' | wc -l""",>= 2
9. Check duphong_bond2 - 9d,"cat /proc/net/bonding/\$bond\"" | grep -A 2 'Slave Interface: $interface'| grep 'MII Status' | awk '{print $3}'""",'up' for each interface
10. Check duphong_bond3 - 10a,dmidecode -t system | grep -w 'VMware\|RDO',Contains VMware or RDO
10. Check duphong_bond3 - 10b,ip a | grep 'bond[0-9]:' | awk '{print $2}' | awk -F: '{print $1}' | grep 'bond[0-9]' | grep -v '@bond',List of bond interfaces
10. Check duphong_bond3 - 10c,"cat /etc/sysconfig/network-scripts/ifcfg-$bond | grep -v ^# | grep mode | cut -d '\' -f 2 | awk '{print $1}'""","Valid mode (mode=0,1,2,4,5)"
10. Check duphong_bond3 - 10d,cat /proc/net/bonding/$bond | grep 'Bonding Mode',Mode matching config
11. Check san_multipath - 11a,dmsetup status| grep -vw linear |awk '{print $1}'| sed -e 's/://g'| grep -v p[0-9]$| grep -v No,List of multipath devices
11. Check san_multipath - 11b,multipath -ll $device | grep running$ | wc -l,>= 4 for each device
12. Check kdump_service - 12a,systemctl status kdump-tools | grep 'Active: active',Non-empty result (service active)
13. Check sendmail_off - 13a,systemctl status sendmail | grep 'Active: active',Empty result (service not active)
14. Check postfix_off - 14a,systemctl status postfix | grep 'Active: active',Empty result (service not active)
15. Check bash_thay_dash1 - 15a,cat /etc/passwd | grep -v bash | awk -F: '($3>=1000) {print $1}' | grep -v nobody,Empty result (all users use bash)
16. Check bash_thay_dash2 - 16a,cat /etc/default/useradd | grep -v ^# | grep -w 'SHELL=/bin/bash',Non-empty result (bash configured)
17. Check bo_card_mang_ao - 17a,ifconfig -a | grep virbr,Empty result (no virtual interfaces)
18. Check appamor_disable - 18a,systemctl status apparmor | grep 'Active: active',Empty result (AppArmor not active)
19. Check nf_conntrack_max - 19a,test -f /proc/sys/net/nf_conntrack_max,File exists
19. Check nf_conntrack_max - 19b,cat /proc/sys/net/nf_conntrack_max,>= 524288
20. Check hashsize - 20a,test -f /proc/sys/net/netfilter/nf_conntrack_buckets,File exists
20. Check hashsize - 20b,cat /proc/sys/net/netfilter/nf_conntrack_buckets,>= 131072
21. Check pass_never_expired - 21a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with bash
21. Check pass_never_expired - 21b,chage -l $user | grep 'Password expires' | awk '{print $4}','never' for each user
22. Check max_open_file_user - 22a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with bash
22. Check max_open_file_user - 22b,cat /etc/security/limits.conf | grep -v ^# | grep -w $user | grep -v soft | grep -w nofile,Non-empty result for each user
23. Check max_process_user - 23a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with bash
23. Check max_process_user - 23b,cat /etc/security/limits.conf | grep -v ^# | grep -w $user | grep -v soft | grep -w nproc,Non-empty result for each user
24. Check max_open_file_user - 24a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with bash
24. Check max_open_file_user - 24b,cat /etc/security/limits.conf | grep -v ^# | grep -w $user | grep -v soft | grep -w nproc,Non-empty result for each user
25. Check cupsd_off - 25a,systemctl status cups | grep 'Active: active',Empty result (service not active)
26. Check bluetooth_off - 26a,systemctl status bluetooth | grep 'Active: active',Empty result (service not active)
27. Check per_user_trong_groupsudo1 - 27a,cat /etc/pam.d/su | grep -v ^# | grep -w auth | grep -w required | grep -w pam_wheel.so,Non-empty result (pam_wheel configured)
28. Check per_user_trong_groupsudo2 - 28a,cat /etc/passwd |grep sh$ | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with shell access
28. Check per_user_trong_groupsudo2 - 28b,cat /etc/group | grep sudo | grep $user,"Empty result for app users (except monitor, vt_admin)"
29. Check per_user_trong_groupsudo3 - 29a,cat /etc/passwd |grep sh$ | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with shell access
29. Check per_user_trong_groupsudo3 - 29b,cat /etc/group | grep adm | grep $user,"Empty result for app users (except monitor, vt_admin)"
30. Check password1 - 30a,dpkg -s libpam-pwquality | grep 'ok installed',Non-empty result (package installed)
31. Check password2 - 31a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'minlen = 8',Non-empty result (minlen configured)
32. Check password3 - 32a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'dcredit = -1',Non-empty result (dcredit configured)
33. Check password4 - 33a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'ucredit = -1',Non-empty result (ucredit configured)
34. Check password5 - 34a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'lcredit = -1',Non-empty result (lcredit configured)
35. Check password6 - 35a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'ocredit = -1',Non-empty result (ocredit configured)
36. Check password7 - 36a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'maxrepeat = 3',Non-empty result (maxrepeat configured)
37. Check password8 - 37a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'enforcing = 1',Non-empty result (enforcing configured)
38. Check password9 - 38a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'retry = 3',Non-empty result (retry configured)
39. Check password10 - 39a,cat /etc/security/pwquality.conf | grep -v ^# | grep -w 'enforce_for_root',Non-empty result (enforce_for_root configured)
40. Check pass_encryp_1 - 40a,cat /etc/pam.d/common-password | grep -v ^# | grep -w password | grep -w pam_unix.so | grep -w sha512,Non-empty result (sha512 configured)
41. Check pass_encryp_2 - 41a,cat /etc/pam.d/common-password | grep -v ^# | grep -w password | grep -w pam_pwhistory.so | grep -w 'remember=5',Non-empty result (remember=5 configured)
42. Check thuat_toan_mahoa - 42a,cat /etc/login.defs | grep -v ^# | grep -w ENCRYPT_METHOD | grep -w SHA512,Non-empty result (SHA512 configured)
43. Check cau_hinh_ssh_protocol - 43a,cat /etc/ssh/sshd_config | grep -v ^# | grep -w 'Protocol 2',Non-empty result (Protocol 2 configured)
44. Check cau_hinh_ssh_permitrootlogin - 44a,cat /etc/ssh/sshd_config | grep -v ^# | grep -w 'PermitRootLogin no',Non-empty result (PermitRootLogin no configured)
45. Check cau_hinh_ssh_allowusers - 45a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with bash
45. Check cau_hinh_ssh_allowusers - 45b,cat /etc/ssh/sshd_config | grep -v ^# | grep -w AllowUsers | grep -w $user,Contains user for each user
46. Check tudong_off_ssh_1 - 46a,cat /etc/passwd |grep /bin/bash | grep -v ^# | grep -v nfsnobody | awk -F: '($3>=400) {print $1}',List of users with bash
46. Check tudong_off_ssh_1 - 46b,cat /etc/ssh/sshd_config | grep -v ^# | grep -w AllowUsers | grep -w $user,Contains user for each user
47. Check tudong_off_ssh_2 - 47a,cat /etc/profile | grep -v ^# | grep 'TMOUT=300' | wc -l,Exactly 1 (configured once)
48. Check bandwidth_net - 48a,ip a | grep 'state UP' | awk '{print $2}'| awk -F: '{print $1}',List of UP network interfaces
48. Check bandwidth_net - 48b,"ethtool \$interface\"" | grep 'Speed' | awk '{print $2}'| awk -FM '{print $1}'""",>= 1000 Mb/s for each interface
49. Check openssl_ver - 49a,openssl version -a,"Contains whitelisted version (1.0.1e, 1.0.2k, 1.0.1u, 1.0.2j, 1.1.0a, 1.1.0g, 1.0.2n, 1.1.1k, 3.2.2)"
50. Check file_unowner - 50a,find / -xdev \\( -nouser -o -nogroup \\) -print,Empty result (no unowned files)
51. Check bien_moitruong - 51a,echo $PATH | grep '\\.\\./\\|::\\|/tmp',Empty result (no dangerous paths)
52. Check cau_hinh_crontab1 - 52a,ls /etc/ | grep cron.deny,Empty result (file removed)
53. Check cau_hinh_crontab2 - 53a,ls /etc/ | grep cron.allow,Non-empty result (file exists)
54. Check cau_hinh_crontab_min - 54a,crontab -l | grep -v ^# | grep -v 'sd_agent' | grep -v 'scms-agent',Empty result (no other crontabs)
54. Check cau_hinh_crontab_min - 54b,crontab -l | grep -v ^# | grep sd_agent | grep sd_agent_monitor.sh,Non-empty result (sd_agent configured)
54. Check cau_hinh_crontab_min - 54c,crontab -l | grep -v ^# | grep scms-agent | grep scms-mon,Non-empty result (scms-agent configured)
55. Check cau_hinh_crontab_root - 55a,crontab -l -u root | grep -v ^# | grep -v 'sd_agent' | grep -v 'scms-agent',Empty result (no other root crontabs)
55. Check cau_hinh_crontab_root - 55b,crontab -l -u root | grep -v ^# | grep sd_agent | grep sd_agent_monitor.sh,Non-empty result (sd_agent configured)
55. Check cau_hinh_crontab_root - 55c,crontab -l -u root | grep -v ^# | grep scms-agent | grep scms-mon,Non-empty result (scms-agent configured)
56. Check cau_hinh_at1 - 56a,ls /etc/ | grep at.deny,Empty result (file removed)
57. Check cau_hinh_at2 - 57a,ls /etc/ | grep at.allow,Non-empty result (file exists)
58. Check cau_hinh_at_min - 58a,atq | grep -v 'no files in queue',Empty result (no at jobs)
59. Check cau_hinh_at_root - 59a,atq -u root | grep -v 'no files in queue',Empty result (no root at jobs)
60. Check cau_hinh_log_rsyslog - 60a,ps -ef | grep rsyslog | grep -v grep,Non-empty result (rsyslog running)
61. Check cau_hinh_log_logrotate - 61a,ls /etc/logrotate.d/ | wc -l,>= 1 (logrotate configs exist)
62. Check cau_hinh_log_syslog - 62a,cat /etc/rsyslog.conf | grep -v ^# | grep '*.info;mail.none;authpriv.none;cron.none',Non-empty result (syslog configured)
63. Check cau_hinh_log_secure - 63a,cat /etc/rsyslog.conf | grep -v ^# | grep 'authpriv.*',Non-empty result (secure log configured)
64. Check cau_hinh_log_maillog - 64a,cat /etc/rsyslog.conf | grep -v ^# | grep 'mail.*',Non-empty result (mail log configured)
65. Check cau_hinh_log_cron - 65a,cat /etc/rsyslog.conf | grep -v ^# | grep 'cron.*',Non-empty result (cron log configured)
66. Check cau_hinh_log_boot - 66a,cat /etc/rsyslog.conf | grep -v ^# | grep 'local7.*',Non-empty result (boot log configured)
67. Check cau_hinh_log_spooler - 67a,"cat /etc/rsyslog.conf | grep -v ^# | grep 'uucp,news.crit'",Non-empty result (spooler log configured)
68. Check cau_hinh_log_emerg - 68a,cat /etc/rsyslog.conf | grep -v ^# | grep '*.emerg',Non-empty result (emergency log configured)
69. Check cau_hinh_auditd - 69a,ps -ef | grep auditd | grep -v grep,Non-empty result (auditd running)
70. Check cau_hinh_audit_log - 70a,cat /etc/audit/auditd.conf | grep -v ^# | grep 'log_file',Contains log file path
71. Check cau_hinh_audit_rules - 71a,cat /etc/audit/audit.rules | grep -v ^# | wc -l,>= 1 (audit rules exist)
72. Check cau_hinh_sysctl - 72a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.ip_forward',Contains 'net.ipv4.ip_forward = 0'
73. Check cau_hinh_sysctl_icmp - 73a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.icmp_echo_ignore_broadcasts',Contains 'net.ipv4.icmp_echo_ignore_broadcasts = 1'
74. Check cau_hinh_sysctl_redirect - 74a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.conf.all.accept_redirects',Contains 'net.ipv4.conf.all.accept_redirects = 0'
75. Check cau_hinh_sysctl_source_route - 75a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.conf.all.accept_source_route',Contains 'net.ipv4.conf.all.accept_source_route = 0'
76. Check cau_hinh_sysctl_log_martians - 76a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.conf.all.log_martians',Contains 'net.ipv4.conf.all.log_martians = 1'
77. Check cau_hinh_sysctl_rp_filter - 77a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.conf.all.rp_filter',Contains 'net.ipv4.conf.all.rp_filter = 1'
78. Check cau_hinh_sysctl_tcp_syncookies - 78a,cat /etc/sysctl.conf | grep -v ^# | grep 'net.ipv4.tcp_syncookies',Contains 'net.ipv4.tcp_syncookies = 1'
79. Check cau_hinh_hosts_allow - 79a,cat /etc/hosts.allow | grep -v ^# | wc -l,>= 1 (hosts.allow configured)
80. Check cau_hinh_hosts_deny - 80a,cat /etc/hosts.deny | grep -v ^# | grep 'ALL:ALL',Contains 'ALL:ALL' (deny all by default)
81. Check cau_hinh_xinetd - 81a,ps -ef | grep xinetd | grep -v grep,Empty result (xinetd not running)
82. Check cau_hinh_telnet - 82a,ps -ef | grep telnet | grep -v grep,Empty result (telnet not running)
83. Check cau_hinh_ftp - 83a,ps -ef | grep ftp | grep -v grep,Empty result (ftp not running)
84. Check cau_hinh_rsh - 84a,ps -ef | grep rsh | grep -v grep,Empty result (rsh not running)
85. Check cau_hinh_rlogin - 85a,ps -ef | grep rlogin | grep -v grep,Empty result (rlogin not running)
86. Check cau_hinh_rcp - 86a,ps -ef | grep rcp | grep -v grep,Empty result (rcp not running)
