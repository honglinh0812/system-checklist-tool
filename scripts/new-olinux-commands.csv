Command Name,Command,Reference Value
1. Check tach_var_ra_khoi_source - a,"dmidecode -t system | grep -wE 'RDO'",Get list/check prerequisite
1. Check tach_var_ra_khoi_source - b,"grep -w '\s/var\s' /etc/fstab",Empty result
2. Check phan_vung_ud_ko_nam_chung_source - a,"grep -Ev '^\s*#' /etc/fstab | grep -Ewv '/$|/var$|/dev/shm$|/home$|/usr$|/proc$|/sys$|/dev/pts$|/opt$|swap|/boot$|/boot/efi$'",Empty result
3. Check timezone - a,"date +'%Z %z' | grep -w '+0700'",Contains '+0700'
4. Check sudoers1 - a,"echo -e '%wheel\tALL=(ALL)\tALL'",Get list/check prerequisite
4. Check sudoers1 - b,"grep -Ev '^\s*#' /etc/sudoers | grep -F '{{ standard }}'",Empty result
5. Check sudoers2 - a,"echo -e 'ALL=(ALL)\tALL'",Get list/check prerequisite
5. Check sudoers2 - b,"awk -F: '($7==\"/bin/bash\" && $3>=400 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",Empty result
5. Check sudoers2 - c,"grep -Ev '^\s*#' /etc/sudoers | grep -w '{{ i }}' | grep -F '{{ standard }}'",Empty result
6. Check sudoers3 - a,"echo -e 'ALL=(ALL)  NOPASSWD: ALL'",Get list/check prerequisite
6. Check sudoers3 - b,"awk -F: '($7==\"/bin/bash\" && $3>=400 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",Empty result
6. Check sudoers3 - c,"grep -Ev '^\s*#' /etc/sudoers | grep -w '{{ i }}' | grep -F '{{ standard }}'",Empty result
7. Check ud_ko_dung_root - a,"ps -eo user,comm | awk '$1==\"root\" && $2 ~ /(java|tomcat|jre|jdk|kubelet)/{print}'",Empty result
8. Check duphong_bond1 - a,"dmidecode -t system | grep -wE 'VMware|RDO'",Get list/check prerequisite
8. Check duphong_bond1 - b,"ip -o link show | awk -F': ' '{print $2}' | grep -E '^bond[0-9]($|@)' | sed 's/@.*//'",Empty result
8. Check duphong_bond1 - c,"grep -c '^Slave Interface' /proc/net/bonding/{{ i }}",Empty result
8. Check duphong_bond1 - d,"awk '/^Slave Interface/{print $3}' /proc/net/bonding/{{ i }}",Empty result
8. Check duphong_bond1 - e,"awk -v IF='{{ j }}' 'f&&/^MII Status/{print $3;f=0} /^Slave Interface: /{f=($3==IF)}' /proc/net/bonding/{{ i }}",Empty result
9. Check duphong_bond2 - a,"dmidecode -t system | grep -wE 'VMware|RDO'",Get list/check prerequisite
9. Check duphong_bond2 - b,"ip -o link show | awk -F': ' '{print $2}' | grep -E '^bond[0-9]($|@)' | sed 's/@.*//'",Empty result
9. Check duphong_bond2 - c,"awk -F': ' '/^Bonding Mode:/{print $2}' /proc/net/bonding/{{ i }} | grep -oE 'balance-rr|active-backup|balance-xor|broadcast|802\.3ad|balance-tlb|balance-alb'",Empty result
9. Check duphong_bond2 - d,"grep -F 'Bonding Mode' /proc/net/bonding/{{ i }}",Empty result
10. Check san_multipath - a,"dmsetup status | grep -vw linear | awk '{print $1}' | sed -e 's/://g' | grep -v 'p[0-9]$' | grep -v '^$'",Get list/check prerequisite
10. Check san_multipath - b,"multipath -ll {{ line }} | grep -c 'running$'",Empty result
11. Check kdump_service - a,"systemctl status kdump.service 2>/dev/null | grep 'Active: active'",Empty result
12. Check sendmail_off - a,"systemctl status sendmail 2>/dev/null | grep 'Active: active'",Empty result
13. Check postfix_off - a,"systemctl status postfix 2>/dev/null | grep 'Active: active'",Empty result
14. Check hearbeat_port - a,"ip -o link show {{ line }} | grep -w 'mtu 9000'",Empty result
15. Check bo_card_mang_ao - a,"ip -o link show | awk -F': ' '{print $2}' | grep -w 'virbr0'",Get list/check prerequisite
15. Check bo_card_mang_ao - b,"grep -Ev '^\s*#' /etc/selinux/config | grep -w 'SELINUX='",Empty result
15. Check bo_card_mang_ao - c,"sestatus 2>/dev/null | grep -F 'Current mode' | grep -w enforcing",Empty result
17. Check nf_conntrack_max - a,"cat /proc/sys/net/nf_conntrack_max",Empty result
18. Check hashsize - a,"cat /proc/sys/net/netfilter/nf_conntrack_buckets",Empty result
19. Check pass_never_expired - a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nobody\"){print $1}' /etc/passwd",Get list/check prerequisite
19. Check pass_never_expired - b,"chage -l {{ user }} | awk -F': ' '/Password expires/{print $2}' | awk '{print $1}'",Specific value match
20. Check max_open_file_user - a,"awk -F: '($7==\"/bin/bash\" && $3>=400 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",Get list/check prerequisite
20. Check max_open_file_user - b,"grep -Ev '^\s*#' /etc/security/limits.conf | awk -v U='{{ user }}' '$0 ~ (\"^\" U \"\\s\") && $2!=\"soft\" && $3==\"nofile\"'",Non-empty result
21. Check max_process_user - a,"awk -F: '($7==\"/bin/bash\" && $3>=400 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",Get list/check prerequisite
21. Check max_process_user - b,"grep -Ev '^\s*#' /etc/security/limits.conf | awk -v U='{{ user }}' '$0 ~ (\"^\" U \"\\s\") && $2!=\"soft\" && $3==\"nproc\"'",Non-empty result
22. Check max_open_file_user - a,"cat /proc/sys/fs/file-max",Get list/check prerequisite
22. Check max_open_file_user - b,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -w 'fs.file-max'",Non-empty result
23. Check bluetooth_off - a,"systemctl status bluetooth 2>/dev/null | grep 'Active: active'",Empty result
24. Check cupsd_off - a,"systemctl status cups 2>/dev/null | grep 'Active: active'",Empty result
25. Check per_user_trong_groupsudo1 - a,"grep -Ev '^\s*#' /etc/pam.d/su | grep -w auth | grep -w required | grep -w pam_wheel.so",Empty result
26. Check per_user_trong_groupsudo2 - a,"awk -F: '($7==\"/bin/bash\" && $3>=400 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",Get list/check prerequisite
26. Check per_user_trong_groupsudo2 - b,"getent group wheel | awk -F: '{print $4}' | tr ',' '\n' | grep -w '{{ user }}'",Empty result
27. Check password1 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'minlen\s*=\s*8'",Empty result
28. Check password2 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'dcredit\s*=\s*-1'",Empty result
29. Check password3 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'ucredit\s*=\s*-1'",Empty result
30. Check password4 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'lcredit\s*=\s*-1'",Empty result
31. Check password5 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'ocredit\s*=\s*-1'",Empty result
32. Check password6 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'maxrepeat\s*=\s*3'",Empty result
33. Check password7 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'enforcing\s*=\s*1'",Empty result
34. Check password8 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'retry\s*=\s*3'",Empty result
35. Check password9 - a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'enforce_for_root'",Empty result
36. Check pass_encryp_1 - a,"grep -Ev '^\s*#' /etc/pam.d/password-auth | grep -w password | grep -w sha512",Empty result
37. Check pass_encryp_2 - a,"grep -Ev '^\s*#' /etc/security/pwhistory.conf | grep -w 'remember\s*=\s*5'",Empty result
38. Check thuat_toan_mahoa - a,"grep -Ev '^\s*#' /etc/login.defs | grep -w 'ENCRYPT_METHOD\s\+SHA512'",Empty result
39. Check cau_hinh_ssh_protocol - a,"grep -Ev '^\s*#' /etc/ssh/sshd_config | grep -w 'Protocol 2'",Empty result
40. Check cau_hinh_ssh_permitrootlogin - a,"grep -Ev '^\s*#' /etc/ssh/sshd_config | grep -w 'PermitRootLogin\s\+no'",Empty result
41. Check cau_hinh_ssh_allowusers - a,"awk -F: '($7==\"/bin/bash\" && $3>=400 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",Get list/check prerequisite
41. Check cau_hinh_ssh_allowusers - b,"grep -Ev '^\s*#' /etc/ssh/sshd_config | awk -v U='{{ user }}' '$0 ~ /^AllowUsers/ && $0 ~ (\"(^|\\s)\" U \"(\\s|$)\")'",Specific value match
42. Check tudong_off_ssh_1 - a,"grep -Ev '^\s*#' /etc/profile | grep -w 'TMOUT=300' -A 2 | grep -w 'readonly TMOUT' -A 1 | grep -w 'export TMOUT'",Empty result
43. Check tudong_off_ssh_2 - a,"grep -Ev '^\s*#' /etc/profile | grep -w 'TMOUT=300' | wc -l",Specific value match
44. Check bandwidth_net - a,"ip -o link show up | awk -F': ' '{print $2}' | sed 's/@.*//'",Get list/check prerequisite
44. Check bandwidth_net - b,"ethtool {{ i }} | awk '/Speed:/{print $2}' | awk -FM '{print $1}'",>= 1000
45. Check openssl_ver - a,"openssl version -a | grep -F '{{ i }}'",Non-empty result
46. Check file_unowner - a,"find / -xdev \( -nouser -o -nogroup \) -print",Empty result
47. Check bien_moitruong - a,"printf '%s\n' \"${PATH}\" | grep -E '\./|::|/tmp'",Empty result
48. Check cau_hinh_crontab1 - a,"test -f /etc/cron.deny && echo found",Empty result
49. Check cau_hinh_crontab2 - a,"test -f /etc/cron.allow && echo found",Empty result
50. Check cau_hinh_crontab_min - a,"crontab -l 2>/dev/null | grep -Ev '^\s*#' | grep -Ev 'sd_agent|scms-agent'",Get list/check prerequisite
50. Check cau_hinh_crontab_min - b,"crontab -l 2>/dev/null | grep -Ev '^\s*#' | grep -F 'sd_agent' | grep -F 'sd_agent_monitor.sh'",Empty result
50. Check cau_hinh_crontab_min - c,"crontab -l 2>/dev/null | grep -Ev '^\s*#' | grep -F 'scms-agent' | grep -F 'scms-mon'",Empty result
50. Check cau_hinh_crontab_min - d,"grep -Ev '^\s*#' /etc/logrotate.conf | grep -w '{{ i }}'",Empty result
50. Check cau_hinh_crontab_min - e,"grep -Ev '^\s*#' /etc/logrotate.d/syslog | grep -w '{{ i }}'",Empty result
50. Check cau_hinh_crontab_min - f,"grep -Ev '^\s*#' /etc/logrotate.d/iptables | grep -w '{{ i }}'",Empty result
50. Check cau_hinh_crontab_min - g,"grep -Ev '^\s*#' /etc/logrotate.d/btmp | grep -w '{{ i }}'",Empty result
50. Check cau_hinh_crontab_min - h,"grep -Ev '^\s*#' /etc/logrotate.d/wtmp | grep -w '{{ i }}'",Empty result
50. Check cau_hinh_crontab_min - i,"grep -Ev '^\s*#' /etc/bashrc | grep -F 'local6.debug' | grep -F 'ctty'",Empty result
50. Check cau_hinh_crontab_min - j,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -w '{{ i }}'",Empty result
50. Check cau_hinh_crontab_min - k,"tail -100 /var/log/cmdlog.log 2>/dev/null | grep -F '{{ value }}'",Empty result
50. Check cau_hinh_crontab_min - l,"grep -Ev '^\s*#' /etc/bashrc | grep -F 'export PROMPT_COMMAND' | grep -F 'local6.debug' | wc -l",Empty result
50. Check cau_hinh_crontab_min - m,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -F 'local6' | grep -F '/var/log/cmdlog.log' | wc -l",Empty result
50. Check cau_hinh_crontab_min - n,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -F 'kern.debug' | grep -F '/var/log/iptables/iptables.log' | wc -l",Empty result
62. Check iptables_status - a,"systemctl status iptables 2>/dev/null | grep 'Active: active'",Empty result
63. Check zone_reclaim_mode - a,"cat /proc/sys/vm/zone_reclaim_mode",Specific value match
64. Check mysql_not_active - a,"ps -eo user,comm | grep -w mysql | grep -v '^root '",Empty result
65. Check phan_vung_swap - a,"tail -n +2 /proc/swaps",Empty result
66. Check oracle_scan_order - a,"grep -Ev '^\s*#' /etc/sysconfig/oracleasm | grep -w 'ORACLEASM_SCANORDER' | grep -i dm | wc -l",Specific value match
66. Check oracle_scan_order - b,"grep -Ev '^\s*#' /etc/sysconfig/oracleasm | grep -w 'ORACLEASM_SCANEXCLUDE' | grep -i sd | wc -l",Specific value match
67. Check haveged_service_on - a,"dmidecode -t system | grep -wiE 'Vmware|OpenStack'",Get list/check prerequisite
67. Check haveged_service_on - b,"rpm -qa | grep -w haveged",Empty result
67. Check haveged_service_on - c,"service haveged status 2>/dev/null | grep -w running",Empty result
68. Check basic_package - a,"rpm -qa | grep -E '^{{ i }}-'",Non-empty result
69. Check swappiness - a,"cat /proc/sys/vm/swappiness",Empty result
70. Check repo_taptrung - a,"curl --connect-timeout 3 -s -o /dev/null -I -w %{http_code} 10.60.129.132",Condition-based
71. Check chronyd_status - a,"systemctl status chronyd 2>/dev/null | grep 'Active: active'",Empty result
72. Check chronyd_config - a,"grep -Ev '^\s*#' /etc/chrony.conf | grep -w '{{ chrony_server }}'",Empty result
73. Check time_synchronization - a,"chronyc sources | awk -v S='{{ chrony_server }}' '$0 ~ S {print $5}'",Specific value match
74. Check lldp_service - a,"dmidecode -t system | grep -wE 'VMware|RDO'",Get list/check prerequisite
74. Check lldp_service - b,"rpm -qa | grep -E '^lldpd-'",Non-empty result
75. Check lldp_show_neighbor - a,"dmidecode -t system | grep -wE 'VMware|RDO'",Get list/check prerequisite
75. Check lldp_show_neighbor - b,"lldpcli show neighbors | grep -F 'LLDP neighbors:'",Non-empty result
76. Check ipx_installed - a,"command -v ipx 2>/dev/null | grep -F '/bin/ipx'",Empty result
77. Check iptables1 - a,"iptables -S INPUT 2>/dev/null | tail -1 | grep -E '\-A INPUT \-j (DROP|REJECT)'",Empty result
78. Check iptables2 - a,"iptables -S INPUT 2>/dev/null | tail -2 | head -1 | grep -E '\-A INPUT \-j LOG'",Empty result
79. Check iptables3 - a,"iptables -S OUTPUT 2>/dev/null | tail -1 | grep -E '\-A OUTPUT \-j (DROP|REJECT)'",Empty result
80. Check iptables4 - a,"iptables -S OUTPUT 2>/dev/null | tail -2 | head -1 | grep -E '\-A OUTPUT \-j LOG'",Empty result
