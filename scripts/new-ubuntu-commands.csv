Command Name,Command,Reference Value
1. Check tach_var_ra_khoi_source - 1a,"dmidecode -t system | grep -wE 'RDO|VMware'",Empty result (no VMware/RDO)
1. Check tach_var_ra_khoi_source - 1b,"grep -w '\s/var\s' /etc/fstab",Non-empty result (partition exists)
2. Check phan_vung_ud_ko_nam_chung_source - 2a,"grep -Ev '^\s*#' /etc/fstab | grep -Ewv '/$|/var$|/dev/shm$|/home$|/usr$|/proc$|/sys$|/dev/pts$|/opt$|swap|/boot$|/boot/efi$'",Non-empty result (application partitions exist)
3. Check timezone - 3a,"date +'%Z %z' | grep -w '+0700'",Contains '+0700'
4. Check sudoers1 - 4a,"grep -Ev '^\s*#' /etc/sudoers | grep -F '%sudo	ALL=(ALL:ALL) ALL'",Empty result (rule not exists)
5. Check sudoers2 - 5a,"grep -Ev '^\s*#' /etc/sudoers | grep -F '%admin ALL=(ALL) ALL'",Empty result (rule not exists)
6. Check sudoers3 - 6a,"awk -F: '($7 ~ /sh$/ && $3>=1000){print $1}' /etc/passwd",List of users with shell access
6. Check sudoers3 - 6b,"grep -Ev '^\s*#' /etc/sudoers | grep -w '{{ user }}' | grep -F 'ALL=(ALL:ALL) ALL'",Empty result for each user
7. Check ud_ko_dung_root - 7a,"ps -eo user,comm | awk '$1==\"root\" && $2 ~ /(java|tomcat|jre|jdk|kubelet)/{print}'",Empty result (no root processes)
8. Check duphong_bond1 - 8a,"ps -eo user,comm | awk '$1==\"root\" && $2 ~ /(java|tomcat|jre|jdk|kubelet)/{print}'",Empty result (no root processes)
9. Check duphong_bond2 - 9a,"dmidecode -t system | grep -wE 'VMware|RDO'",Contains VMware or RDO
9. Check duphong_bond2 - 9b,"ip -o link show | awk -F': ' '{print $2}' | grep -E '^bond[0-9]($|@)' | sed 's/@.*//'",List of bond interfaces
9. Check duphong_bond2 - 9c,"grep -c '^Slave Interface' /proc/net/bonding/{{ bond }}",">= 2"
9. Check duphong_bond2 - 9d,"awk -v IFACE='{{ interface }}' 'f&&/^MII Status/{print $3;f=0} /^Slave Interface: /{f=($3==IFACE)}' /proc/net/bonding/{{ bond }}","'up' for each interface"
10. Check duphong_bond3 - 10a,"dmidecode -t system | grep -wE 'VMware|RDO'",Contains VMware or RDO
10. Check duphong_bond3 - 10b,"ip -o link show | awk -F': ' '{print $2}' | grep -E '^bond[0-9]($|@)' | sed 's/@.*//'",List of bond interfaces
10. Check duphong_bond3 - 10c,"awk -F': ' '/^Bonding Mode:/{print $2}' /proc/net/bonding/{{ bond }} | grep -oE 'balance-rr|active-backup|balance-xor|broadcast|802\.3ad|balance-tlb|balance-alb'",Valid mode (mode=0,1,2,4,5)
10. Check duphong_bond3 - 10d,"grep -F 'Bonding Mode' /proc/net/bonding/{{ bond }}",Mode matching config
11. Check san_multipath - 11a,"dmsetup status | grep -vw linear | awk '{print $1}' | sed -e 's/://g' | grep -v 'p[0-9]$' | grep -v '^$'",List of multipath devices
11. Check san_multipath - 11b,"multipath -ll {{ device }} | grep -c 'running$'",">= 4 for each device"
12. Check kdump_service - 12a,"systemctl status kdump-tools 2>/dev/null | grep 'Active: active'",Non-empty result (service active)
13. Check sendmail_off - 13a,"systemctl status sendmail 2>/dev/null | grep 'Active: active'",Empty result (service not active)
14. Check postfix_off - 14a,"systemctl status postfix 2>/dev/null | grep 'Active: active'",Empty result (service not active)
15. Check bash_thay_dash1 - 15a,"awk -F: '($7!=\"/bin/bash\" && $3>=1000 && $1!=\"nobody\"){print $1}' /etc/passwd",Empty result (all users use bash)
16. Check bash_thay_dash2 - 16a,"grep -Ev '^\s*#' /etc/default/useradd | grep -w 'SHELL=/bin/bash'",Non-empty result (bash configured)
17. Check bo_card_mang_ao - 17a,"ip -o link show | awk -F': ' '{print $2}' | grep -w 'virbr0'",Empty result (no virtual interfaces)
18. Check appamor_disable - 18a,"systemctl status apparmor 2>/dev/null | grep 'Active: active'",Empty result (AppArmor not active)
19. Check nf_conntrack_max - 19a,"test -f /proc/sys/net/nf_conntrack_max && echo OK",File exists
19. Check nf_conntrack_max - 19b,"cat /proc/sys/net/nf_conntrack_max",">= 524288
20. Check hashsize - 20a,"test -f /proc/sys/net/netfilter/nf_conntrack_buckets && echo OK",File exists
20. Check hashsize - 20b,"cat /proc/sys/net/netfilter/nf_conntrack_buckets",">= 131072
21. Check pass_never_expired - 21a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with bash
21. Check pass_never_expired - 21b,"chage -l {{ user }} | awk -F': ' '/Password expires/{print $2}'",''never' for each user
22. Check max_open_file_user - 22a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with bash
22. Check max_open_file_user - 22b,"grep -Ev '^\s*#' /etc/security/limits.conf | awk -v U='{{ user }}' '$0 ~ U && $3==\"nofile\" && $2!=\"soft\"'",Non-empty result for each user
23. Check max_process_user - 23a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with bash
23. Check max_process_user - 23b,"grep -Ev '^\s*#' /etc/security/limits.conf | awk -v U='{{ user }}' '$0 ~ U && $3==\"nproc\" && $2!=\"soft\"'",Non-empty result for each user
24. Check max_open_file_user - 24a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with bash
24. Check max_open_file_user - 24b,"grep -Ev '^\s*#' /etc/security/limits.conf | awk -v U='{{ user }}' '$0 ~ U && $3==\"nproc\" && $2!=\"soft\"'",Non-empty result for each user
25. Check cupsd_off - 25a,"systemctl status cups 2>/dev/null | grep 'Active: active'",Empty result (service not active)
26. Check bluetooth_off - 26a,"systemctl status bluetooth 2>/dev/null | grep 'Active: active'",Empty result (service not active)
27. Check per_user_trong_groupsudo1 - 27a,"grep -Ev '^\s*#' /etc/pam.d/su | grep -w auth | grep -w required | grep -w pam_wheel.so",Non-empty result (pam_wheel configured)
28. Check per_user_trong_groupsudo2 - 28a,"awk -F: '($7 ~ /sh$/ && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with shell access
28. Check per_user_trong_groupsudo2 - 28b,"getent group sudo | awk -F: '{print $4}' | tr ',' '\n' | grep -w '{{ user }}'","Empty result for app users (except monitor, vt_admin)
29. Check per_user_trong_groupsudo3 - 29a,"awk -F: '($7 ~ /sh$/ && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with shell access
29. Check per_user_trong_groupsudo3 - 29b,"getent group adm | awk -F: '{print $4}' | tr ',' '\n' | grep -w '{{ user }}'","Empty result for app users (except monitor, vt_admin)
30. Check password1 - 30a,"dpkg -s libpam-pwquality 2>/dev/null | grep -F 'Status: install ok installed'",Non-empty result (package installed)
31. Check password2 - 31a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'minlen\s*=\s*8'",Non-empty result (minlen configured)
32. Check password3 - 32a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'dcredit\s*=\s*-1'",Non-empty result (dcredit configured)
33. Check password4 - 33a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'ucredit\s*=\s*-1'",Non-empty result (ucredit configured)
34. Check password5 - 34a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'lcredit\s*=\s*-1'",Non-empty result (lcredit configured)
35. Check password6 - 35a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'ocredit\s*=\s*-1'",Non-empty result (ocredit configured)
36. Check password7 - 36a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'maxrepeat\s*=\s*3'",Non-empty result (maxrepeat configured)
37. Check password8 - 37a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'enforcing\s*=\s*1'",Non-empty result (enforcing configured)
38. Check password9 - 38a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'retry\s*=\s*3'",Non-empty result (retry configured)
39. Check password10 - 39a,"grep -Ev '^\s*#' /etc/security/pwquality.conf | grep -w 'enforce_for_root'",Non-empty result (enforce_for_root configured)
40. Check pass_encryp_1 - 40a,"grep -Ev '^\s*#' /etc/pam.d/common-password | grep -w password | grep -w pam_unix.so | grep -w sha512",Non-empty result (sha512 configured)
41. Check pass_encryp_2 - 41a,"grep -Ev '^\s*#' /etc/pam.d/common-password | grep -w password | grep -w pam_pwhistory.so | grep -w 'remember=5'",Non-empty result (remember=5 configured)
42. Check thuat_toan_mahoa - 42a,"grep -Ev '^\s*#' /etc/login.defs | grep -w 'ENCRYPT_METHOD\s\+SHA512'",Non-empty result (SHA512 configured)
43. Check cau_hinh_ssh_protocol - 43a,"grep -Ev '^\s*#' /etc/ssh/sshd_config | grep -w 'Protocol 2'",Non-empty result (Protocol 2 configured)
44. Check cau_hinh_ssh_permitrootlogin - 44a,"grep -Ev '^\s*#' /etc/ssh/sshd_config | grep -w 'PermitRootLogin\s\+no'",Non-empty result (PermitRootLogin no configured)
45. Check cau_hinh_ssh_allowusers - 45a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with bash
45. Check cau_hinh_ssh_allowusers - 45b,"grep -Ev '^\s*#' /etc/ssh/sshd_config | awk -v U='{{ user }}' '$0 ~ /^AllowUsers/ && $0 ~ (\"(^|\\s)\" U \"(\\s|$)\")'",Contains user for each user
46. Check tudong_off_ssh_1 - 46a,"awk -F: '($7==\"/bin/bash\" && $3>=1000 && $1!=\"nfsnobody\"){print $1}' /etc/passwd",List of users with bash
46. Check tudong_off_ssh_1 - 46b,"grep -Ev '^\s*#' /etc/ssh/sshd_config | awk -v U='{{ user }}' '$0 ~ /^AllowUsers/ && $0 ~ (\"(^|\\s)\" U \"(\\s|$)\")'",Contains user for each user
47. Check tudong_off_ssh_2 - 47a,"grep -Ev '^\s*#' /etc/profile | grep -w 'TMOUT=300' | wc -l",Exactly 1 (configured once)
48. Check bandwidth_net - 48a,"ip -o link show up | awk -F': ' '{print $2}' | sed 's/@.*//'",List of UP network interfaces
48. Check bandwidth_net - 48b,"ethtool {{ interface }} | awk '/Speed:/{print $2}' | awk -FM '{print $1}'",">= 1000 Mb/s for each interface
49. Check openssl_ver - 49a,"openssl version -a | grep -E 'OpenSSL (1\.0\.1e|1\.0\.2k|1\.0\.1u|1\.0\.2j|1\.1\.0a|1\.1\.0g|1\.0\.2n|1\.1\.1k|3\.2\.2)'",Contains whitelisted version (1.0.1e, 1.0.2k, 1.0.1u, 1.0.2j, 1.1.0a, 1.1.0g, 1.0.2n, 1.1.1k, 3.2.2)
50. Check file_unowner - 50a,"find / -xdev \( -nouser -o -nogroup \) -print",Empty result (no unowned files)
51. Check bien_moitruong - 51a,"printf '%s\n' \"${PATH}\" | grep -E '\.\./|::|/tmp'",Empty result (no dangerous paths)
52. Check cau_hinh_crontab1 - 52a,"test -f /etc/cron.deny && echo found",Empty result (file removed)
53. Check cau_hinh_crontab2 - 53a,"test -f /etc/cron.allow && echo found",Non-empty result (file exists)
54. Check cau_hinh_crontab_min - 54a,"crontab -l 2>/dev/null | grep -Ev '^\s*#' | grep -Ev 'sd_agent|scms-agent'",Empty result (no other crontabs)
54. Check cau_hinh_crontab_min - 54b,"crontab -l 2>/dev/null | grep -Ev '^\s*#' | grep -F 'sd_agent' | grep -F 'sd_agent_monitor.sh'",Non-empty result (sd_agent configured)
54. Check cau_hinh_crontab_min - 54c,"crontab -l 2>/dev/null | grep -Ev '^\s*#' | grep -F 'scms-agent' | grep -F 'scms-mon'",Non-empty result (scms-agent configured)
55. Check cau_hinh_crontab_root - 55a,"crontab -l -u root 2>/dev/null | grep -Ev '^\s*#' | grep -Ev 'sd_agent|scms-agent'",Empty result (no other root crontabs)
55. Check cau_hinh_crontab_root - 55b,"crontab -l -u root 2>/dev/null | grep -Ev '^\s*#' | grep -F 'sd_agent' | grep -F 'sd_agent_monitor.sh'",Non-empty result (sd_agent configured)
55. Check cau_hinh_crontab_root - 55c,"crontab -l -u root 2>/dev/null | grep -Ev '^\s*#' | grep -F 'scms-agent' | grep -F 'scms-mon'",Non-empty result (scms-agent configured)
56. Check cau_hinh_at1 - 56a,"test -f /etc/at.deny && echo found",Empty result (file removed)
57. Check cau_hinh_at2 - 57a,"test -f /etc/at.allow && echo found",Non-empty result (file exists)
58. Check cau_hinh_at_min - 58a,"atq 2>/dev/null | grep -v 'no files in queue'",Empty result (no at jobs)
59. Check cau_hinh_at_root - 59a,"atq -u root 2>/dev/null | grep -v 'no files in queue'",Empty result (no root at jobs)
60. Check cau_hinh_log_rsyslog - 60a,"ps -eo comm | grep -w rsyslogd | grep -v grep",Non-empty result (rsyslog running)
61. Check cau_hinh_log_logrotate - 61a,"ls -1 /etc/logrotate.d/ 2>/dev/null | wc -l",">= 1 (logrotate configs exist)
62. Check cau_hinh_log_syslog - 62a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -F '*.info;mail.none;authpriv.none;cron.none'",Non-empty result (syslog configured)
63. Check cau_hinh_log_secure - 63a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -E 'authpriv\.\*'",Non-empty result (secure log configured)
64. Check cau_hinh_log_maillog - 64a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -E 'mail\.\*'",Non-empty result (mail log configured)
65. Check cau_hinh_log_cron - 65a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -E 'cron\.\*'",Non-empty result (cron log configured)
66. Check cau_hinh_log_boot - 66a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -E 'local7\.\*'",Non-empty result (boot log configured)
67. Check cau_hinh_log_spooler - 67a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -F 'uucp,news.crit'",Non-empty result (spooler log configured)
68. Check cau_hinh_log_emerg - 68a,"grep -Ev '^\s*#' /etc/rsyslog.conf | grep -F '*.emerg'",Non-empty result (emergency log configured)
69. Check cau_hinh_auditd - 69a,"ps -eo comm | grep -w auditd | grep -v grep",Non-empty result (auditd running)
70. Check cau_hinh_audit_log - 70a,"grep -Ev '^\s*#' /etc/audit/auditd.conf | grep -w 'log_file'",Contains log file path
71. Check cau_hinh_audit_rules - 71a,"grep -Ev '^\s*#' /etc/audit/audit.rules | wc -l",">= 1 (audit rules exist)
72. Check cau_hinh_sysctl - 72a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.ip_forward = 0'",Contains 'net.ipv4.ip_forward = 0'
73. Check cau_hinh_sysctl_icmp - 73a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.icmp_echo_ignore_broadcasts = 1'",Contains 'net.ipv4.icmp_echo_ignore_broadcasts = 1'
74. Check cau_hinh_sysctl_redirect - 74a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.conf.all.accept_redirects = 0'",Contains 'net.ipv4.conf.all.accept_redirects = 0'
75. Check cau_hinh_sysctl_source_route - 75a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.conf.all.accept_source_route = 0'",Contains 'net.ipv4.conf.all.accept_source_route = 0'
76. Check cau_hinh_sysctl_log_martians - 76a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.conf.all.log_martians = 1'",Contains 'net.ipv4.conf.all.log_martians = 1'
77. Check cau_hinh_sysctl_rp_filter - 77a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.conf.all.rp_filter = 1'",Contains 'net.ipv4.conf.all.rp_filter = 1'
78. Check cau_hinh_sysctl_tcp_syncookies - 78a,"grep -Ev '^\s*#' /etc/sysctl.conf | grep -F 'net.ipv4.tcp_syncookies = 1'",Contains 'net.ipv4.tcp_syncookies = 1'
79. Check cau_hinh_hosts_allow - 79a,"test -f /etc/hosts.allow && grep -Ev '^\s*#' /etc/hosts.allow | wc -l",">= 1 (hosts.allow configured)
80. Check cau_hinh_hosts_deny - 80a,"grep -Ev '^\s*#' /etc/hosts.deny | grep -Fx 'ALL:ALL'",Contains 'ALL:ALL' (deny all by default)
81. Check cau_hinh_xinetd - 81a,"ps -eo comm | grep -w xinetd | grep -v grep",Empty result (xinetd not running)
82. Check cau_hinh_telnet - 82a,"ps -eo comm | grep -w telnetd | grep -v grep",Empty result (telnet not running)
83. Check cau_hinh_ftp - 83a,"ps -eo comm | grep -Ew 'vsftpd|proftpd|pure-ftpd' | grep -v grep",Empty result (ftp not running)
84. Check cau_hinh_rsh - 84a,"ps -eo comm | grep -w rshd | grep -v grep",Empty result (rsh not running)
85. Check cau_hinh_rlogin - 85a,"ps -eo comm | grep -w rlogind | grep -v grep",Empty result (rlogin not running)
86. Check cau_hinh_rcp - 86a,"ps -eo comm | grep -w rcp | grep -v grep",Empty result (rcp not running)
